/*
 * jQuery PickList 0.2.2
 *
 * http://code.google.com/p/jquery-picklist/
 *
 * Copyright (c) 2010 GengWei
 *
 * Licensed under the Apache License, Version 2.0:
 *   http://www.opensource.org/licenses/apache2.0.php
 */

$(function(){function g(a){this.options={};$.extend(this.options,this.defaults,a);a=this.context=this.options.context;this.availableList=$(this.options.availableList_selector,a);this.pickedList=$(this.options.pickedList_selector,a);this.addButton=$(this.options.addButton_selector,a);this.removeButton=$(this.options.removeButton_selector,a);this.init()}g.prototype={defaults:{context:"body",availableList_selector:"#availableList",pickedList_selector:"#pickedList",item_selector:"li",addButton_selector:"#btnAdd", removeButton_selector:"#btnRemove",selectedItemClassName:"selectedItem",hoverItemClassName:"hoverItem"},setDefaults:function(a){$.extend(this.defaults,a)},init:function(){this.initList(this.availableList);this.initList(this.pickedList);var a=this;this.addButton.click(function(){a.addButtonClicked()});this.removeButton.click(function(){a.removeButtonClicked()})},initList:function(a){var b=this.options;a.click(function(c){var d=$(c.target);d.is(b.item_selector)||(d=d.parents(b.item_selector).eq(0)); var e=a.find(b.item_selector);if(c.ctrlKey)d.toggleClass(b.selectedItemClassName);else{e.removeClass(b.selectedItemClassName);d.addClass(b.selectedItemClassName)}if(c.shiftKey)if(c=a.lastClickedItem){var f=e.index(c),h=e.index(d);c=Math.min(f,h);f=Math.max(f,h);for(i=c;i<=f;i++)e.eq(i).addClass(b.selectedItemClassName)}a.lastClickedItem=d;return false}).mouseover(function(c){c=$(c.target);c.is(b.item_selector)||(c=c.parents(b.item_selector).eq(0));c&&c.addClass(b.hoverItemClassName);if($(this).is(b.availableList_selector))b.hoverOverAvailableItem&& b.hoverOverAvailableItem();else $(this).is(b.pickedList)&&b.hoverOverPickedItem&&b.hoverOverPickedItem();return false}).mouseout(function(c){c=$(c.target);c.is(b.item_selector)||(c=c.parents(b.item_selector).eq(0));c&&c.removeClass(b.hoverItemClassName);if($(this).is(b.availableList_selector))b.hoverOutAvailableItem&&b.hoverOutAvailableItem();else $(this).is(b.pickedList)&&b.hoverOutPickedItem&&b.hoverOutPickedItem();return false})},containsItem:function(a,b){var c=null,d=parseInt($.trim(b.find(".idCol").text()), 10);a.find(".idCol").each(function(){if(parseInt($.trim($(this).text()),10)===d){c=$(this);return false}});return c},moveItems:function(a,b,c,d){var e=this.options,f=a.find("."+e.selectedItemClassName);if(f.size()>0){if(c&&c(this)===false)return false;var h=this;f.remove().each(function(){var j=h.containsItem&&h.containsItem(b,$(this));j?j.closest(e.item_selector).addClass(e.selectedItemClassName):b.append($(this))});a.lastClickedItem=null;d&&d(this)}},addButtonClicked:function(){this.moveItems(this.availableList, this.pickedList,this.options.beforeAdd,this.options.afterAdd);return false},removeButtonClicked:function(){this.moveItems(this.pickedList,this.availableList);return false},getPickedItems:function(){return this.pickedList.find(this.options.item_selector)},getAvailableItems:function(){return this.availableList.find(this.options.item_selector)},getSelectedPickedItems:function(){return this.pickedList.find("."+this.options.selectedItemClassName)},getSelectedAvailableItems:function(){return this.availableList.find("."+ this.options.selectedItemClassName)},getLastClickedAvailableItem:function(){return this.availableList.lastClickedItem},getLastClickedPickedItem:function(){return this.pickedItem.lastClickedItem},clearPickedList:function(){this.pickedList.empty();this.pickedList.lastClickedItem=null;return this},clearAvailableList:function(){this.availableList.empty();this.availableList.lastClickedItem=null;return this},insertAvailableItems:function(a){this.availableList.append(a);return this},insertPickedItems:function(a){this.pickedList.append(a); return this}};$.extend({pickList:function(a){return new g(a)}});$.pickList.setDefaults=function(a){$.extend(g.prototype.defaults,a)};$.pickList.prototype=g.prototype;$.fn.extend({pickList:function(a){$.extend(a,{context:$(this)});return new g(a)}})});